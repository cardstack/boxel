{
  "data": {
    "meta": {
      "adoptsFrom": {
        "name": "Skill",
        "module": "https://cardstack.com/base/skill"
      }
    },
    "type": "card",
    "attributes": {
      "title": "Template Patterns",
      "cardInfo": {
        "notes": null,
        "title": null,
        "description": null,
        "thumbnailURL": null
      },
      "commands": [],
      "description": "Template syntax, field access patterns, fallbacks, and array handling",
      "instructions": "## Template Essentials\n\n**Field access patterns:**\n```hbs\n{{@model.title}}                    <!-- Raw data -->\n<@fields.title />                   <!-- Field's template -->\n<@fields.phone @format=\"atom\" />    <!-- Compound field -->\n<@fields.items @format=\"embedded\" /> <!-- Auto-collection -->\n```\n\n**Null handling (cards boot with no data!):**\n```hbs\n{{if @model.title @model.title \"Untitled\"}}\n{{#if @model.description}}\n  <@fields.description />\n{{else}}\n  <p>No description yet</p>\n{{/if}}\n```\n\n**Array handling:**\n```hbs\n{{#if (gt @model.items.length 0)}}\n  {{#each @model.items as |item|}}\n    <li>{{item}}</li>\n  {{/each}}\n{{else}}\n  <p>No items yet</p>\n{{/if}}\n```\n\n**Spacing for collections:**\n```css\n.container > .containsMany-field {\n  gap: 0.75rem;  /* REQUIRED */\n}\n```\n\n<!--more-->\n\n# Template Field Access Patterns\n\n**CRITICAL:** Understanding when to use different field access patterns prevents rendering errors.\n\n| Pattern | Usage | Purpose | Example |\n|---------|-------|---------|----------|\n| `{{@model.title}}` | **Raw Data Access** | Get raw field values for computation/display | `{{@model.title}}` gets the title string |\n| `<@fields.title />` | **Field Template Rendering** | Render field using its own template | `<@fields.title />` renders title field's embedded template |\n| `<@fields.phone @format=\"atom\" />` | **Compound Field Display** | Display compound fields (FieldDef) correctly | Prevents `[object Object]` display |\n| `<@fields.author />` | **Single Field Delegation** | Delegate rendering for ANY field (singular or collection) | Always use `@fields`, even for singular entities |\n| `<@fields.blogPosts @format=\"embedded\" />` | **Auto-Collection Rendering** | Default container automatically iterates collections (**CRITICAL:** Must use `.container > .containsMany-field` selector for spacing) | `<div class=\"items\"><@fields.blogPosts @format=\"embedded\" /></div>` with `.items > .containsMany-field { gap: 1rem; }` |\n| `{{#each @fields.blogPosts as |post|}}` | **Manual Collection Iteration** | Manual loop control with custom rendering | `{{#each @fields.blogPosts as |post|}}<post @format=\"fitted\" />{{/each}}` |\n| `{{get @model.comments 0}}` | **Array Index Access** | Access array elements by index | `{{get @model.comments 0}}` gets first comment |\n| `{{if @model.description @model.description \"No description available\"}}` | **Inline Fallback Values** | Provide defaults for missing values in single line | Shows fallback when description is empty or null |\n| `{{currencyFormat @model.totalCost 'USD'}}` | **Currency Formatting** | Format numbers as currency in templates (use i18n in JS) | `{{currencyFormat @model.totalCost 'USD'}}` shows $1,234.56 |\n| `{{formatDateTime @model.publishDate 'MMM D, YYYY'}}` | **Date Formatting** | Format dates in templates (use i18n in JS) | `{{formatDateTime @model.publishDate 'MMM D, YYYY'}}` shows Jan 15, 2025 |\n| `<PrerenderedCardSearch>` | **Query Result Display** | Live card search with real-time updates | See Query System section |\n\n### ‚ö†Ô∏è CRITICAL: @model Iteration vs @fields Delegation\n\n**Once you iterate with @model, you CANNOT delegate to @fields within that iteration.**\n\n```hbs\n<!-- ‚ùå BREAKS: Mixing @model iteration with @fields delegation -->\n{{#each @model.teamMembers as |member|}}\n  <@fields.member @format=\"embedded\" />  <!-- NO ACCESS to @fields.member -->\n{{/each}}\n\n<!-- ‚úÖ OPTION 1: Use delegated rendering for the whole collection -->\n<@fields.teamMembers @format=\"embedded\" />\n\n<!-- ‚úÖ OPTION 2: Commit to full @model control -->\n{{#each @model.teamMembers as |member|}}\n  <div class=\"custom-member\">{{member.name}}</div>\n{{/each}}\n\n<!-- ‚úÖ OPTION 3: If filtering needed, use query patterns -->\n<!-- Use PrerenderedCardSearch or getCards for filtered collections -->\n```\n\n**Why this breaks:** @fields provides field-level components. Once you're iterating with @model, you're working with raw data, not field components.\n\n**Decision Rule:** Before iterating, decide:\n- Need composability? ‚Üí Use delegated rendering\n- Need filtering? ‚Üí Use query patterns (PrerenderedCardSearch/getCards)\n- Need custom control? ‚Üí Use @model but handle ALL rendering yourself\n\n### Styling Responsibility Model\n\n**Core Rule: Container provides frame, content provides data**\n\n**Visual Chrome (border, shadow, radius, background):**\n- **Isolated/Embedded/Fitted/Edit:** Parent or CardContainer handles\n- **Atom:** Self-styles (inline use case)\n\n**Layout:** Parent controls container dimensions and spacing via `.containsMany-field`\n\n### Displaying Compound Fields\n\n**CRITICAL:** When displaying compound fields (FieldDef types) like `PhoneNumberField`, `AddressField`, or custom field definitions, you must use their format templates, not raw model access:\n\n```hbs\n<!-- ‚ùå WRONG: Shows [object Object] -->\n<p>Phone: {{@model.phone}}</p>\n\n<!-- ‚úÖ CORRECT: Uses the field's atom format -->\n<p>Phone: <@fields.phone @format=\"atom\" /></p>\n\n<!-- ‚úÖ CORRECT: For full field display -->\n<div class=\"contact-info\">\n  <@fields.phone @format=\"embedded\" />\n</div>\n```\n\n**üí° Line-saving tip:** Keep self-closing tags compact:\n```hbs\n<!-- Good: Saves vertical space -->\n<@fields.author @format=\"embedded\" />\n<@fields.phone @format=\"atom\" />\n```\n\n### @fields Delegation Rule\n\n**CRITICAL:** When delegating to embedded/fitted formats, you must iterate through `@fields`, not `@model`. Always use `@fields` for delegation, even for singular fields. See \"‚ö†Ô∏è CRITICAL: @model Iteration vs @fields Delegation\" section for why you cannot mix these patterns.\n\n```hbs\n<!-- ‚úÖ CORRECT: Using @fields for both singular and collection fields -->\n<@fields.author @format=\"embedded\" />\n<@fields.items @format=\"embedded\" />\n{{#each @fields.items as |item|}}\n  <item @format=\"embedded\" />\n{{/each}}\n\n<!-- ‚ùå WRONG: Can't iterate @model then try to delegate to @fields -->\n{{#each @model.items as |item|}}\n  <@fields.??? @format=\"embedded\" /> <!-- This won't work -->\n{{/each}}\n```\n\n**Line-saving tip:** Put `/>` on the end of the previous line for self-closing tags:\n```hbs\n<!-- Instead of: -->\n<@fields.author @format=\"embedded\" \n/>\n\n<!-- Use: -->\n<@fields.author @format=\"embedded\" />\n```\n\n**containsMany Spacing Pattern:** Due to an additional wrapper div, target `.containsMany-field`:\n```css\n/* For grids */\n.products-grid > .containsMany-field {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 1rem;\n}\n\n/* For lists */\n.items-list > .containsMany-field {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n```\n\n## Template Fallback Value Patterns\n\n**CRITICAL:** Boxel cards boot with no data by default. Templates must gracefully handle null, undefined, and empty string values at ALL levels of data access to prevent runtime errors and provide meaningful visual fallbacks.\n\n### Three Primary Patterns for Fallbacks\n\n**1. Inline if/else (for simple display fallbacks):**\n```hbs\n<span>{{if @model.eventTime (formatDateTime @model.eventTime \"MMM D, h:mm A\") \"Event time to be announced\"}}</span>\n<h2>{{if @model.title @model.title \"Untitled Document\"}}</h2>\n<p>Status: {{if @model.status @model.status \"Status pending\"}}</p>\n```\n\n**2. Block-based if/else (for complex content):**\n```hbs\n<div class=\"event-time\">\n  {{#if @model.eventTime}}\n    <strong>{{formatDateTime @model.eventTime \"MMM D, h:mm A\"}}</strong>\n  {{else}}\n    <em class=\"placeholder\">Event time to be announced</em>\n  {{/if}}\n</div>\n\n{{#if @model.description}}\n  <div class=\"description\">\n    <@fields.description />\n  </div>\n{{else}}\n  <div class=\"empty-description\">\n    <p>No description provided yet. Click to add one.</p>\n  </div>\n{{/if}}\n```\n\n**3. Unless for safety/validation checks (composed with other helpers):**\n```hbs\n{{unless (and @model.isValid @model.hasPermission) \"‚ö†Ô∏è Cannot proceed - missing validation or permission\"}}\n{{unless (or @model.email @model.phone) \"Contact information required\"}}\n{{unless (gt @model.items.length 0) \"No items available\"}}\n{{unless (eq @model.status \"active\") \"Service unavailable\"}}\n```\n\n**Best Practices:** Use descriptive placeholder text rather than generic \"N/A\", style placeholder text differently (lighter color, italic), use `unless` for safety checks and `if` for display fallbacks.\n\n**Icon Usage:** Avoid emoji in templates (unless the application specifically calls for it) due to OS/platform variations that cause legibility issues. Use Boxel icons only for static card/field type icons (displayName properties). In templates, use inline SVG instead since we can't be sure which Boxel icons exist.\n\n## Template Array Handling Patterns\n\n**CRITICAL:** Templates must gracefully handle all array states to prevent errors. Arrays can be undefined, null, empty, or populated.\n\n### The Three Array States\n\nYour templates must handle:\n1. **Completely undefined arrays** - Field doesn't exist or is null\n2. **Empty arrays** - Field exists but has no items (`[]`)\n3. **Arrays with actual data** - Field has one or more items\n\n### Array Logic Pattern\n\n**‚ùå WRONG - Only checks for existence:**\n```hbs\n{{#if @model.goals}}\n  <ul class=\"goals-list\">\n    {{#each @model.goals as |goal|}}\n      <li>{{goal}}</li>\n    {{/each}}\n  </ul>\n{{/if}}\n```\n\n**‚úÖ CORRECT - Checks for length and provides empty state:**\n```hbs\n{{#if (gt @model.goals.length 0)}}\n  <div class=\"goals-section\">\n    <h4>\n      <svg class=\"section-icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle cx=\"12\" cy=\"12\" r=\"6\"/>\n        <circle cx=\"12\" cy=\"12\" r=\"2\"/>\n      </svg>\n      Daily Goals\n    </h4>\n    <ul class=\"goals-list\">\n      {{#each @model.goals as |goal|}}\n        <li>{{goal}}</li>\n      {{/each}}\n    </ul>\n  </div>\n{{else}}\n  <div class=\"goals-section\">\n    <h4>\n      <svg class=\"section-icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n        <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle cx=\"12\" cy=\"12\" r=\"6\"/>\n        <circle cx=\"12\" cy=\"12\" r=\"2\"/>\n      </svg>\n      Daily Goals\n    </h4>\n    <p class=\"empty-state\">No goals set yet. What would you like to accomplish?</p>\n  </div>\n{{/if}}\n```\n\n### Complete Array Handling Example with Required Spacing\n\n```gts\n<template>\n  {{#if (gt @model.teamMembers.length 0)}}\n    <section class=\"team-section\">\n      <h3>Team Members</h3>\n      <div class=\"team-container\">\n        <@fields.teamMembers @format=\"fitted\" />\n      </div>\n    </section>\n  {{else}}\n    <section class=\"team-section\">\n      <h3>Team Members</h3>\n      <div class=\"empty-state\">\n        <p>No team members added yet. Invite your first team member!</p>\n      </div>\n    </section>\n  {{/if}}\n  \n  <style scoped>\n    /* CRITICAL: Target .containsMany-field for proper spacing */\n    .team-container > .containsMany-field {\n      display: flex;\n      flex-direction: column;\n      gap: 0.75rem; /* Essential spacing between delegated items */\n    }\n    \n    .empty-state {\n      text-align: center;\n      padding: 1rem;\n      color: #6b7280;\n      font-style: italic;\n      font-size: 0.8125rem;\n    }\n  </style>\n</template>\n```\n\n**Remember:** When implementing templates via SEARCH/REPLACE, include tracking markers ‚Åø for style blocks"
    },
    "relationships": {
      "cardInfo.theme": {
        "links": {
          "self": null
        }
      }
    }
  }
}